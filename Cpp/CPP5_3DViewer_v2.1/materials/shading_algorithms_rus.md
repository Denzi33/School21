# Основные подходы к закраске

На базовом уровне, для закраски некоторого пикселя изображения достаточно знать интенсивность этого пикселя, выраженную через три компоненты: R, G и B каналы. Интенсивность пикселя высчитывается как интенсивность той части объекта, которая изображена на данном пикселе. Интенсивность объекта зависит от расположения источников освещения. Для вычисления интенсивности любой части объекта можно использовать несколько подходов:

## Плоское затенение (Flat shading)

Интенсивность вычисляется один раз для каждого полигона, и является его усредненным значением:

$` I=I_0 cos \phi `$, если $`0 \leq \phi \leq \pi / 2`$, иначе $`I = 0`$.

Здесь угол $`\phi`$ является углом между нормалью к поверхности и вектором направления к источнику света, а $`I_0`$ - базовое значение интенсивности источника света.

## Закраска методом Гуро

Интенсивность интерполируется для любого пикселя составляющего двумерное отображение полигона. Объект получается более "гладким". Для этого требуется:

- Вычисление нормали вершин полигона (вертексов), путем векторного сложения нормалей к поверхностям смежных граней вертекса. То есть для вычисления вертекса *A*, необходимо сложить векторы нормалей к граням *1*, *2*, *3* и *4*.

- Вычисление интенсивности вершин по формуле $`I=I_0 cos \phi`$, если $`0 \leq \phi \leq \pi / 2`$, иначе $`I = 0`$.

- Вычисление интенсивности всех внутренних пикселей полигона, путем двумерной линейной интерполяции интенсивности. Пусть $`O`$ некоторый произвольный пиксель внутри полигона, тогда проведем горизонтальную прямую линию через точку $`O`$ и обозначим точки пересечения с ребрами грани как $`P`$ и $`Q`$. Тогда интенсивность $`O`$ можно линейно проинтерполировать на отрезке $`PQ`$, следующим образом:

$`I_O = (1 - \frac{|PO|}{|PQ|})I_P + \frac{|PO|}{|PQ|}I_Q`$

Интенсивности для точек $`P`$ и $`Q`$ аналогично интерполируются на соответствующих ребрах с известными значениями интенсивностей для вершин.

Метод может быть в значительной степени оптимизирован, так как интенсивность в пределах одной горизонтальной линии для каждого пикселя может быть вычислена из предыдущей путем прибавления фиксированного значения, то есть обладает линейным ростом/падением. Точно так же изменение интенсивностей для точек на ребрах является линейным. Инкрементная реализация линейной интерполяции всегда предпочтительнее.

## Закраска методом Фонга

Закраска методом Фонга развивает идею закраски Гуро, но в данном случае интерполируется не значение интенсивности, а сам нормированный вектор нормали. Таким образом, метод подразумевает следующие шаги:

- Вычисляются нормали вершин полигона (вертексов), путем векторного сложения нормалей к поверхностям смежных граней вертекса. Вектора нормируются.

- Линейно интерполируется вектор нормали (все три компонента) для каждого пикселя аналогичным образом интенсивности при закраске методом Гуро.

- Вычисляется интенсивность для нового вектора.

Фонг вычисляется несколько дольше, так как требуется интерполяция трех значений компонент вектора, а не только одного значения интенсивности, но результат получается более точный. 
