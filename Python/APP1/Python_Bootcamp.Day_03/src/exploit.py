from bs4 import BeautifulSoup  # Module for work with html-file

# The first part of exercise - read full file:
with open("../materials/evilcorp.html") as html_file:
    file = BeautifulSoup(html_file, features="lxml")  # Create a file tree

# The second part of task - change title:
file.head.title.string = "Evil Corp - Stealing your money every day"

# The third part of the task - parse pronoun and name:
pronoun_with_name = file.find("span", class_="name").text  # Parce process
pronoun_with_name = pronoun_with_name + ", you are hacked!"  # Prepare full phrase

file.select_one("p[style=\"display: block;\"]").decompose()  # Delete  tag

new_tag = file.new_tag("h1")  # Create new tag
new_tag.string = pronoun_with_name

file.body.insert(0, new_tag)  # Put new pronoun and name

# The fourth part of a task - insert script:
with open("../materials/script.txt") as scr:
    contents = scr.read()

new_tag = file.new_tag("script")  # Create new tag
new_tag.string = contents  # Put the code of script inside

file.body.insert(5, new_tag)

# The fifth part of task - change link:
new_link = "https://mrrobot.fandom.com/wiki/Fsociety"
file.a["href"] = new_link  # Change link

# Save in file:
evilcorp_hacked = open("../materials/evilcorp_hacked.html", 'w')  # Open file for writing
evilcorp_hacked.write(file.prettify())  # Put changed html code in the final html file
